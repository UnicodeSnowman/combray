<section>

  <%= render partial: 'shared/form_errors', :locals => { instance: @item } %>

  <%= form_for [:admin, @item], html: { multipart: true } do |f| %>

    <p>
      <%= f.label :code %><br />
      <%= f.text_field :code %>
    </p>
    <p>
      <%= f.label :name %><br />
      <%= f.text_field :name %>
    </p>
    <p>
      <%= f.label :description %><br />
      <%= f.text_area :description %>
    </p>
    <p>
      <%= f.label :subcategory %><br /> 
      <%= f.select(:subcategory_id, Subcategory.all.map { |subcategory| [subcategory.category.name + " : " + subcategory.name, subcategory.id] }) %><br /> 
    </p>

    <% number = 0 %>
    <div id='photos'>
      <%= link_to "+ Add Photo",
        new_admin_photo_path,
        :remote => true,
        :update => 'photos',
        :position => 'after',
        :id => 'add_photo_link' %>
        
      <%= render partial: 'admin/photos/form', locals: { number: number } if f.object.new_record? %>
        
    </div>

    <%= f.submit %>

    <% unless f.object.new_record? %>
      <hr />
      <h3>Current Photos</h3>
      <div class="photos">
        <% if @item.photos.length < 1 %>
          no photos
        <% end %>
        <ul class="thumbs">
          <% @item.photos.each do |current_photo| %>
            <li>
              <%= image_tag current_photo.photo.thumb.url %> 
              <%= link_to 'Remove Photo', admin_photo_path(current_photo, :item_id => @item.id), { :method => :delete }%>
            </li>
          <% end %>
        </ul>
      </div>
    
    <% end %>
  

  <% end %>
</section>
